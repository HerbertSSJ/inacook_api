<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Editar Receta - Inacook</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
<div class="container">
    <h1>Editar Receta</h1>
    <form id="editar-receta-form">
        <input type="hidden" id="receta-id">
        <div>
            <label>Nombre</label>
            <input id="nombre_receta" />
        </div>
        <div>
            <label>Categor√≠a</label>
            <input id="categoria" />
        </div>
        <div>
            <label>Procedimiento</label>
            <textarea id="procedimiento"></textarea>
        </div>
        <button class="btn" type="submit">Guardar</button>
    </form>
</div>

<script src="/js/config.js"></script>
<script src="/js/auth.js"></script>
<script src="/js/recipes.js"></script>
<script>
async function loadReceta(id){
    const resp = await fetch(`${API_BASE_URL}/recetas/${id}/`, { headers: {...authHeader()} });
    const data = await resp.json();
    document.getElementById('receta-id').value = data.id;
    document.getElementById('nombre_receta').value = data.Nombre_Receta || '';
    document.getElementById('categoria').value = data.Categoria || '';
    document.getElementById('procedimiento').value = data.Procedimiento || '';
}

document.addEventListener('DOMContentLoaded', ()=>{
    const params = new URLSearchParams(window.location.search);
    const id = params.get('edit');
    if(id) loadReceta(id);
    document.getElementById('editar-receta-form').addEventListener('submit', async e=>{
        e.preventDefault();
        const id = document.getElementById('receta-id').value || params.get('edit');
        const payload = { Nombre_Receta: document.getElementById('nombre_receta').value, Categoria: document.getElementById('categoria').value, Procedimiento: document.getElementById('procedimiento').value };
        try{ await updateRecipe(id, payload); alert('Guardado'); window.location='/ver_recetas'; }catch(err){ alert(err.message); }
    });
});
</script>
</body>
</html>
