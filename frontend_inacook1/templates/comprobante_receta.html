{% extends "base.html" %}
{% load static %}

{% block title %}Comprobante - {{ receta.nombre }}{% endblock %}

{% block content %}
<div class="container comprobante-container">

    <h1>Comprobante de Receta</h1>

    <div class="comprobante-header">
        <p><strong>Receta:</strong> {{ receta.nombre }}</p>
        <p><strong>Categoría:</strong> {{ receta.categoria }}</p>
        <p><strong>Tiempo de preparación:</strong> {{ receta.tiempo_preparacion }}</p>
        <p><strong>Sección:</strong> {% if seccion %}{{ seccion }}{% else %}-{% endif %}</p>
        <p><strong>Asignatura:</strong> {% if asignatura %}{{ asignatura }}{% else %}-{% endif %}</p>
    </div>

    <hr>

    <h2>Ingredientes utilizados</h2>

    <table class="ingredientes-tabla">
        <thead>
            <tr>
                <th>Ingrediente</th>
                <th>Cantidad</th>
                <th>Unidad</th>
                <th>Peso (por unidad)</th>
                <th>Peso total</th>
                <th>Precio Unitario ($)</th>
                <th>Subtotal ($)</th>
            </tr>
        </thead>

        <tbody>
            {% for ing in ingredientes %}
            <tr>
                <td>{{ ing.nombre }}</td>
                <td>{{ ing.cantidad|floatformat:0 }}</td>
                <td>{{ ing.unidad }}</td>
                <td>{% if ing.peso %}{{ ing.peso|floatformat:2 }}{% else %}-{% endif %}</td>
                <td>{% if ing.peso_total %}{{ ing.peso_total|floatformat:2 }}{% else %}-{% endif %}</td>
                <td>${{ ing.precio|floatformat:0 }}</td>
                <td>${{ ing.subtotal|floatformat:0 }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <hr>

    <div class="comprobante-totales">

        {% if comprobante %}
        <p><strong>Subtotal:</strong> ${{ subtotal|floatformat:0 }}</p>
        <p><strong>IVA (19%):</strong> ${{ iva_monto|floatformat:0 }}</p>
        <p><strong>Factor de multiplicación:</strong> {{ comprobante.factor_multiplicacion }}</p>

        <h2><strong>Total final:</strong> ${{ total_final|floatformat:0 }}</h2>
        {% else %}
        <p>No existe un comprobante registrado para esta receta.</p>
        {% endif %}

    </div>

    <div class="acciones-comprobante">
        <a href="{% url 'ver_recetas' %}" class="btn">Volver a mis recetas</a>
    </div>

</div>
{% endblock %}